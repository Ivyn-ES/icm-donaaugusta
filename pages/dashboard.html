<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Completo - ICM</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="container dashboard-card">
        <h1>ğŸ“Š Dashboard ICM</h1>
        <p class="welcome-text">Bem-vindo, <strong id="nomeUsuario"></strong>!</p>
        
        <nav class="menu-nav">
            <a href="lista-presenca.html" class="nav-item">ğŸ“‹ PresenÃ§a Geral</a>
            <a href="relatorios-completo.html" class="nav-item">ğŸ“Š RelatÃ³rios Todos Grupos</a>
            <a href="admin-usuarios.html" class="nav-item">ğŸ‘¨â€âš–ï¸ Gerenciar UsuÃ¡rios</a>
        </nav>
        
        <div class="action-footer">
            <button onclick="mostrarMudarSenha()" class="btn-alt-senha">ğŸ” Alterar Senha</button>
            <a href="../index.html" class="btn-sair">ğŸšª Sair</a>
        </div>

        <div id="formSenha" class="password-box">
            <h4>ğŸ” Alterar Senha</h4>
            <input type="password" id="novaSenha" placeholder="Nova senha (min. 4 dÃ­gitos)">
            <div class="modal-buttons">
                <button onclick="confirmarNovaSenha()" class="btn-confirm">Confirmar</button>
                <button onclick="esconderSenha()" class="btn-cancel">Cancelar</button>
            </div>
        </div>
    </div>
    
    <script src="../js/script.js"></script>
    <script>
        // LÃ³gica de AutenticaÃ§Ã£o
        const user = JSON.parse(localStorage.getItem('usuarioLogado'));
        if (!user || !['completa', 'secretaria'].includes(user.permissoes)) {
            window.location.href = '../index.html';
        }
        document.getElementById('nomeUsuario').textContent = user.nome;
        
        // FunÃ§Ãµes de Interface
        function mostrarMudarSenha() { 
            document.getElementById('formSenha').style.display = 'block'; 
        }
        
        function esconderSenha() {
            document.getElementById('formSenha').style.display = 'none';
            document.getElementById('novaSenha').value = '';
        }

        function confirmarNovaSenha() {
            const novaSenha = document.getElementById('novaSenha').value;
            if (novaSenha.length >= 4) {
                // Tenta chamar a funÃ§Ã£o global do seu script.js
                if (typeof mudarSenha === 'function') {
                    mudarSenha(novaSenha); 
                    alert('âœ… Senha alterada com sucesso!');
                    esconderSenha();
                } else {
                    alert('Erro: FunÃ§Ã£o de alteraÃ§Ã£o nÃ£o encontrada no script.js');
                }
            } else {
                alert('âŒ MÃ­nimo 4 caracteres!');
            }
        }
    </script>
</body>
</html>