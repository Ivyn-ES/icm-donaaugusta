<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Completo - ICM</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š Dashboard Completo ICM Dona Augusta</h1>
        <p>OlÃ¡, <strong id="nomeUsuario"></strong>!</p>
        
        <nav>
            <a href="lista-presenca.html">ğŸ“‹ PresenÃ§a Geral</a>
            <a href="relatorios-completo.html">ğŸ“Š RelatÃ³rios Todos Grupos</a>
            <a href="admin-usuarios.html">ğŸ‘¨â€âš–ï¸ Gerenciar UsuÃ¡rios e Grupos</a>
        </nav>
        
        <div style="margin-top:30px;padding:20px;background:#e9ecef;border-radius:10px;">
            <button onclick="mostrarMudarSenha()" style="background:#007bff;color:white;border:none;padding:12px 24px;border-radius:8px;font-size:16px;">ğŸ” Alterar Senha</button>
            <a href="../index.html" style="margin-left:20px;padding:12px 24px;background:#dc3545;color:white;text-decoration:none;border-radius:8px;">ğŸšª Sair</a>
        </div>
    </div>
    
    <div id="formSenha" style="background:#fff3cd;padding:25px;border-radius:15px;margin:20px;max-width:400px;display:none;">
        <h4>ğŸ” Alterar Senha</h4>
        <input type="password" id="novaSenha" placeholder="Digite sua nova senha" style="width:100%;padding:55px;margin:10px 0;border-radius:8px;border:2px solid #ddd;">
        <div>
            <button onclick="confirmarNovaSenha()" style="background:#28a745;color:white;border:none;padding:12px 24px;border-radius:8px;margin-right:10px;">Confirmar</button>
            <button onclick="esconderSenha()" style="background:#6c757d;color:white;border:none;padding:12px 24px;border-radius:8px;">Cancelar</button>
        </div>
    </div>
    
    <script src="../js/script.js"></script>
    <script>
        const user = JSON.parse(localStorage.getItem('usuarioLogado'));
        if (!user || !['completa', 'secretaria'].includes(user.permissoes)) window.location.href = '../index.html';
        document.getElementById('nomeUsuario').textContent = user.nome;
        
        function mostrarMudarSenha() { document.getElementById('formSenha').style.display = 'block'; }
        function confirmarNovaSenha() {
            const novaSenha = document.getElementById('novaSenha').value;
            if (novaSenha.length >= 4) {
                if (window.parent.mudarSenha) {
                    if (window.parent.mudarSenha(novaSenha)) {
                        document.getElementById('formSenha').style.display = 'none';
                        document.getElementById('novaSenha').value = '';
                        alert('âœ… Senha alterada!');
                    }
                }
            } else alert('âŒ MÃ­nimo 4 caracteres!');
        }
        function esconderSenha() {
            document.getElementById('formSenha').style.display = 'none';
            document.getElementById('novaSenha').value = '';
        }
    </script>
</body>
</html>
